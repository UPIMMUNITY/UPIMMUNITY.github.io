# Initialize home-manager

## Pre-enable flake(Optional)

It's recommended to use home-mannager together with flake enabled.
If you haven't enabled flake yet, do the following for single user:

```bash
echo 'experimental-features = nix-command flakes' >> ~/.config/nix/nix.conf
```

or the following for multi-users:

```bash
echo 'experimental-features = nix-command flakes' >> /etc/nix/nix.conf
```

## Initialize home-manager

Initialize home-manager config by:

```bash
home-manager init
```

This command generates `flake.nix`, `home.nix` under `~/.config/home-manager/`

## Enable flake using home-manager

After setting up home-manager, we can manage nix with it, we don't need to sepcifiy any config in `nix.conf` any more! 
Home-manager will handle things for us.
So add the following to function body in `home.nix` to enable flakes instead of what we just do earlier in `nix.conf`.

```nix
nix = {
  # ...
  settings.experimental-features = ["nix-command" "flakes"];
};
```

## Apply config

If you're ready to restore config specified in `home.nix` to your machine

```bash
home-manager switch
```

This command uses `home.nix` and `flake.nix` under `~/.config/home-manager/` by default.

Currently we just tested the minimal config generated by home-manager, next we'll learn everything home-manager can do.
